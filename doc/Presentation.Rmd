---
title: "Presentation"
author: "Group 11: Freja Dahl Hede, Maika Jensen, Malene Nørregaard Nielsen,<br> Sofie Rossen, Sofie Theisen Honore"
date: May 12th 2021
output: ioslides_presentation
---
<!-- Et slide består normalvis af en overskrift og to chunks
## Overskrift på Slide, e.g. PCA
1. Et slide hvor filen med output sources (benyt include=FALSE), OBS: skriv full path
2. Et slide med output (bruger ggplotly i de fleste tilfælde
-->

<!-- ## Include png example
```{r, out.width="100%"}
knitr::include_graphics('/cloud/project/results/Manhattan_plot.png')
```
-->

<!-- ## Example on how to source files in 
```{r, include=FALSE}
#source(file = "/cloud/project/R/04_analysis_statisticaltests.R",local = knitr::knit_global())
```
-->

```{r setup, include=FALSE}
# Clear workspace ---------------------------------------------------------
rm(list = ls())
knitr::opts_chunk$set(echo = FALSE)

# Load libraries ----------------------------------------------------------
library(plotly)
library(tidyverse)
library(ggplot2)
library(glue)
library(cowplot)
library(lubridate)
library(egg)
library(grid)
library(DT)
library(knitr)
library(kableExtra)
```

```{r, include = FALSE}
#### 1. Prepare Data for printing ####
my_data_raw_counts <- read_csv(file = "/cloud/project/data/_raw/All_Good_P2_C03-1.csv")
my_data_raw_taxonomy <- read_csv(file = "/cloud/project/data/_raw/All_Good_P2_C03_Taxonomy-1.csv")
my_data_raw_ENV <- read_csv(file = "/cloud/project/data/_raw/ENV_pitlatrine.csv")

my_data_clean_aug <- read_tsv(file = "/cloud/project/data/03_my_data_clean_aug.tsv")
#my_data_clean_aug <- tibble(my_data_clean_aug)

#### 2. Convert to interactive table using DT ####
#d <- my_data_clean_aug %>%
#  datatable() %>%
#  formatStyle(columns = colnames(.), fontSize = '10%')

#d=datatable(my_data_clean_aug,width = '90%', options = list(scrollX = TRUE))


#### 3. Convert to HTML widget using htmlwidgets ####
#path <- paste("./dat.html", sep="")
#saveWidget(as_widget(d), file = path)
```

<!-- Introduction -->
# Introduction 
- Explorative data analysis of bacterial latrine data from Tanzania and Vietnam

Torondel, B. et al., (2016), "Assessment of the influence of intrinsic environmental and geographical factors on the bacterial ecology of pit latrines", Microbial Technology

<!-- Important Communicable disease -->


<!-- Materials and methods-->
# Materials & Methods

## Data 
3 sets of raw data
- Abundance data with count per OTU cluster per Sample
- Taxonomy data per OTU cluster
- Environmental metadata per sample

## Extract of Raw Data
```{r}
# Random extract of data. Seed is set to 7 to ensure non-0 rows
set.seed(7)
my_data_raw_counts %>%
  select(1:10) %>%
  slice_sample(n = 10) %>%
  kable("html") %>%
  kable_styling(font_size = 12)
```

## Reference data & Metadata
```{r, out.width='90%'}
# Extraxt of taxonomy data
my_data_raw_taxonomy %>%
  select(1:7) %>%
  slice_sample(n = 5) %>%
  kable("html") %>%
  kable_styling(font_size = 12)

# Extract of meta data
my_data_raw_ENV %>%
  slice_head(n = 5) %>%
  kable("html") %>%
  kable_styling(font_size = 12)
```
## Graphical Representation of Wrangling Process
<!-- Indsæt figurer her -->


## Clean and Augmented Data
```{r}
my_data_clean_aug %>%
  select(Samples, Taxa, site, everything()) %>%
  slice_head(n = 6) %>%
  select(1:10) %>%
  kable("html") %>%
  kable_styling(font_size = 9)
```

# Results
## Summary Statistics


## Initial Exploratory Analysis
```{r, out.width='90%'}
knitr::include_graphics(
  path = '/cloud/project/results/pHandTemp_violinplot.png')
```

## Initial Exploratory Analysis
```{r, out.width='90%'}
knitr::include_graphics(
  path = '/cloud/project/results/correlation_attributest.png')
```

## Initial Exploratory Analysis
```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/heatmap_with_dendrogram.png')
```

## Initial Exploratory Analysis
```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/heatmap_with_totalbar.png')
```

## Principal Components Analysis
```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/pca_plot.png')
```

---

```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/pca_variance_plot.png')
```

## KMeans 
```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/elbowplot.png')
```

## KMeans 
```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/clust_4_pca.png')
```

## T-test of Difference in OTU Count Between Countries
```{r, out.width='90%'}
knitr::include_graphics(
  path = '/cloud/project/results/Manhattan_plot.png')
```

---

```{r, out.width='100%'}
knitr::include_graphics(
  path = '/cloud/project/results/Error_bar_plot_zoom.png')
```

## Sample distributions (Tanzania and Vietnam compared)


### Correlations between Environmental Features and Bacteria where OTU Count Differ Significantly between Countries 
```{r, out.width='90%'}
knitr::include_graphics(
  path = '/cloud/project/results/correlation_attributes_bacteria.png')
```

## Distributions of significant bacteria based on meta data
- Tror meningen er at vi gerne vil trække nogle spændende bakterier ud
- Bacilli er bare et eksempel - Vi skal lige snakke om hvad vi vil

---

```{r, out.width='90%'}
knitr::include_graphics(
  path = '/cloud/project/results/bacilli_pH_barplot.png')
```


# Discussion










# Noget gammelt, jeg ikke tør slette (hvis vi skal bruge noget med plotly senere)
## Distribution of Temperature and pH of the samples
```{r, include=FALSE}
#source(file = "/cloud/project/R/04_analysis_statisticaltests.R",local = knitr::knit_global())
```

```{r}
#ggplotly(depth_dist)
#cowplot::plot_grid(temp_dens, pH_dens, align = "h", ncol = 2, rel_heights = c(0.50, 0.50))
#egg::ggarrange(depth_dist, latrine_dist, heights = c(0.50, 0.50))

#grid.newpage()
#grid.draw(rbind(ggplotGrob(depth_dist), ggplotGrob(latrine_dist), size = "last"))


#subplot(depth_dist, latrine_dist, shareX = FALSE, heights = 0.8)
#sub = subplot(depth_dist, latrine_dist, margin=0.05)
#ggplotly(sub)
```
